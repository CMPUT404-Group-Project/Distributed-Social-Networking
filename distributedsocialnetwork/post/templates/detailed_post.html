{% extends 'base.html' %} 
{% load markup_tags %}
{% block title %} {{ post.title }} {% endblock %}
{% block stylesheet %}
<style>
  .markdown-content{
    --primary-color: black;
    --accent-color: black;
}
.markdown-content img{
  max-width: 400px;
  max-height: 500px;
}
</style> 
{% endblock %}
{% block content %}
  <div class="row p-0 m-0">
    <div class="col sidebar bg-light">
      <!-- Left sidebar content goes here -->
      {% if request.user.is_authenticated and request.user.id == post.author.id%}
      <div class="row p-2 m-2 justify-content-center">
        <a role="button" class="btn btn-lg btn-block btn-outline-primary" href="{{request.path|add:'/edit'}}">Edit</a>
      </div>
      <div class="row p-2 m-2 justify-content-center">
        <a role="button" class="btn btn-lg btn-block btn-outline-primary" href="{{request.path|add:'/delete'}}">Delete</a>
      </div>
      {% endif %}
    </div>
    <div class="col-8 stream bg-white pb-3" id="stream">
      <!-- Main stream content goes here -->
      <!-- The post -->
      <div class="row p-2 justify-content-left">
        <h2>Post</h2>
      </div>
      <div class="card m-2 post">
        <div class="card-body">
          <a class="card-title" href="{{ post.source }}">
            <div class="row-12">
              <h5>{{ post.title }}</h5>
            </div>
          </a>
          <h6 class="card-subtitle mb-2 text-muted">{{ post.description }}</h6>
          {% if post.contentType == 'text/markdown' %}
          <div class="markdown-content col-6">{{ post.content | apply_markup:"markdown" }}</div>
          {% else %}
          <p class="card-text">{{ post.content }}</p>
          {% endif %}
        </div>
        <div class="card-footer text-muted text-right p-2">
          <p class="m-0">{{ post.author.first_name }} {{ post.author.last_name }}</p>
          <p class="small m-0">{{ post.published }}</p>
        </div>
      </div>
      <!-- The comments -->
      <div class="row p-2 justify-content-left">
        <h2>Comments</h2>
      </div>
      {% for comment in comments %}
      <div class="card m-4 comment">
        <div class="card-body">
          {% if comment.contentType == 'text/markdown' %}
          <div class="markdown-content col-6">{{ comment.comment | apply_markup:"markdown" }}</div>
          {% else %}
          <p class="card-text">{{ comment.comment }}</p>
          {% endif %}
        </div>
        <div class="card-footer text-muted text-right p-2">
          <p class="m-0">{{ comment.author.first_name }} {{ comment.author.last_name }}</p>
          <p class="small m-0">{{ comment.published }}</p>
        </div>
      </div>
      {% endfor %}
      <!-- The Comment Form -->
      {% if user.is_authenticated %}
      <div class="row p-2 justify-content-left">
        <h2>Add a Comment:</h2>
      </div>
       <div class="col-12 my-2">
         <form method="POST">
           {% csrf_token %} 
           {% for field in postCommentForm %}
           <div class="card m-2">{{field}}</div>
           {% endfor %}{% if postCommentForm.non_field_errors %}
           <div style="color: red">
           <p>{{postCommentForm.non_field_errors}}</p>	     
           </div>
           {% endif %}
           <button type="submit" class="btn btn-lg btn-block btn-outline-primary">Submit Comment</button>
         </form>	 
       </div>
       {% endif %}
    </div>
    <div class="col text-right sidebar bg-light">
      <!-- Right sidebar content goes here -->
    </div>
  </div>
{% endblock %}